/*
Theme Name: eMINDy
Theme URI: https://emindy.com
Description: A lightweight, accessibility-first WordPress child theme for the eMINDy platform.
Author: eMINDy
Author URI: https://emindy.com
Template: twentytwentyfive
Version: 0.5.0
Text Domain: emindy
*/

/*
Source of truth:
- Colors/typography/spacing: theme.json
- This file: .em-* components, layout tweaks, minimal dark-mode overrides
*/

/* -------------------------------------------------------------------------
Compatibility aliases (no new colors; just mapping to WP presets)
-------------------------------------------------------------------------- */

:root{
  --em-card-shadow: var(--wp--preset--shadow--card);
}

/* -------------------------------------------------------------------------
Accessibility helpers
-------------------------------------------------------------------------- */

.sr-only{
  position:absolute !important;
  width:1px !important;
  height:1px !important;
  padding:0 !important;
  margin:-1px !important;
  overflow:hidden !important;
  clip:rect(0,0,0,0) !important;
  white-space:nowrap !important;
  border:0 !important;
}

.skip-link{
  position:absolute;
  top:0;
  inset-inline-start:0;
  transform:translateY(-120%);
  padding:0.65rem 0.85rem;
  background:var(--wp--preset--color--emindy-surface);
  color:var(--wp--preset--color--emindy-text);
  border:1px solid var(--wp--preset--color--emindy-border);
  border-radius:var(--wp--preset--radius--m);
  z-index:9999;
}
.skip-link:focus{
  transform:translateY(0);
}

/* -------------------------------------------------------------------------
Card shells (extend coverage)
-------------------------------------------------------------------------- */

:where(.em-card, .is-style-em-card, .wp-block-group.is-style-em-card, .wp-block-group.is-style-emindy-card){
  background:var(--wp--preset--color--emindy-surface);
  border:1px solid var(--wp--preset--color--emindy-border);
  border-radius:var(--wp--preset--radius--xl);
  box-shadow:var(--em-card-shadow);
  overflow:hidden;
}

:where(.is-style-em-card):not(.wp-block-group){
  padding:var(--wp--preset--spacing--m);
}

:where(.wp-block-group.is-style-em-card, .wp-block-group.is-style-emindy-card){
  padding:var(--wp--preset--spacing--l);
}

.em-muted{ color:var(--wp--preset--color--emindy-muted); }

.em-admin-note{
  border:1px dashed var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-bg);
  color:var(--wp--preset--color--emindy-muted);
  border-radius:var(--wp--preset--radius--l);
  padding:var(--wp--preset--spacing--m);
}

/* -------------------------------------------------------------------------
Buttons
-------------------------------------------------------------------------- */

.em-button,
.em-share a.em-button,
.em-share button.em-button{
  appearance:none;
  border:1px solid var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-surface);
  color:var(--wp--preset--color--emindy-text);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:0.5rem;
  padding:0.55rem 0.9rem;
  border-radius:999px;
  font-weight:600;
  font-size:var(--wp--preset--font-size--s);
  line-height:1.1;
  text-decoration:none;
  cursor:pointer;
  transition:transform 120ms ease, box-shadow 120ms ease, border-color 120ms ease, background-color 120ms ease;
}
.em-button:hover{
  border-color:var(--wp--preset--color--emindy-teal);
  box-shadow:var(--wp--preset--shadow--soft);
}
.em-button:active{
  transform:translateY(1px);
}
.em-button:focus-visible{
  outline:2px solid var(--wp--preset--color--emindy-teal);
  outline-offset:3px;
}

/* Button block style: em-soft */
.wp-block-button.is-style-em-soft .wp-block-button__link,
.wp-block-button.is-style-em-soft .wp-element-button{
  border:1px solid var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-surface);
  color:var(--wp--preset--color--emindy-text);
  border-radius:999px;
  box-shadow:none;
}
.wp-block-button.is-style-em-soft .wp-block-button__link:hover,
.wp-block-button.is-style-em-soft .wp-element-button:hover{
  border-color:var(--wp--preset--color--emindy-teal);
  box-shadow:var(--wp--preset--shadow--soft);
}

/* Dark-mode toggle button */
.em-dark-mode-toggle{
  border:1px solid var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-surface);
  color:var(--wp--preset--color--emindy-text);
  border-radius:999px;
  padding:0.45rem 0.6rem;
  min-height:2.25rem;
  min-width:2.25rem;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.em-dark-mode-toggle:hover{
  border-color:var(--wp--preset--color--emindy-teal);
  box-shadow:var(--wp--preset--shadow--soft);
}

/* -------------------------------------------------------------------------
Language switcher
-------------------------------------------------------------------------- */

.em-lang-switcher{
  display:flex;
  align-items:center;
  gap:0.5rem;
  flex-wrap:wrap;
}

.em-select{
  position:relative;
  display:inline-flex;
  align-items:center;
  gap:0.5rem;
}

.em-select select,
.em-lang-switcher select{
  background:var(--wp--preset--color--emindy-surface);
  color:var(--wp--preset--color--emindy-text);
  border:1px solid var(--wp--preset--color--emindy-border);
  border-radius:999px;
  padding:0.55rem 2.2rem 0.55rem 0.9rem;
  font-size:var(--wp--preset--font-size--s);
  line-height:1.1;
  appearance:none;
}
.em-select::after{
  content:"";
  position:absolute;
  inset-inline-end:0.9rem;
  width:0.55rem;
  height:0.55rem;
  border-inline-end:2px solid currentColor;
  border-block-end:2px solid currentColor;
  transform:rotate(45deg);
  pointer-events:none;
  opacity:0.7;
}

.em-lang-switcher__chips{
  display:flex;
  flex-wrap:wrap;
  gap:0.35rem;
}

.em-lang-switcher__chip{
  display:inline-flex;
  align-items:center;
  padding:0.35rem 0.75rem;
  border-radius:999px;
  border:1px solid var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-surface);
  color:var(--wp--preset--color--emindy-text);
  text-decoration:none;
  font-size:var(--wp--preset--font-size--xs);
  line-height:1.1;
}
.em-lang-switcher__chip[aria-current="page"]{
  border-color:var(--wp--preset--color--emindy-teal);
  background-color:color-mix(in srgb, var(--wp--preset--color--emindy-surface) 86%, var(--wp--preset--color--emindy-teal) 14%);
}
.em-lang-switcher__chip:hover{
  border-color:var(--wp--preset--color--emindy-teal);
}

/* -------------------------------------------------------------------------
Topic / quick filter pills
-------------------------------------------------------------------------- */

:where(.em-topic-pills, .em-cat-pills, .em-quick-filters){
  display:flex;
  flex-wrap:wrap;
  gap:0.5rem;
  align-items:center;
}

:where(.em-topic-pills .pill, .em-quick-filters .pill, .em-cat-pills a){
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:0.35rem;
  padding:0.35rem 0.8rem;
  border-radius:999px;
  border:1px solid var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-surface) !important;
  color:var(--wp--preset--color--emindy-text) !important;
  font-weight:600;
  font-size:var(--wp--preset--font-size--s);
  line-height:1.1;
  text-decoration:none;
  white-space:nowrap;
  transition:border-color 120ms ease, box-shadow 120ms ease, background-color 120ms ease;
}
:where(.em-topic-pills .pill, .em-quick-filters .pill, .em-cat-pills a):hover{
  border-color:var(--wp--preset--color--emindy-teal);
  box-shadow:var(--wp--preset--shadow--soft);
}
:where(.em-topic-pills .pill, .em-quick-filters .pill, .em-cat-pills a)[aria-current="page"]{
  border-color:var(--wp--preset--color--emindy-teal);
  background-color:color-mix(in srgb, var(--wp--preset--color--emindy-surface) 86%, var(--wp--preset--color--emindy-teal) 14%) !important;
}

/* -------------------------------------------------------------------------
Search
-------------------------------------------------------------------------- */

.em-search-bar{
  display:flex;
  flex-wrap:wrap;
  gap:0.5rem;
  align-items:center;
}

.em-search-bar input[type="search"]{
  border:1px solid var(--wp--preset--color--emindy-border) !important;
  background:var(--wp--preset--color--emindy-surface) !important;
  color:var(--wp--preset--color--emindy-text) !important;
  border-radius:999px !important;
  padding:0.6rem 0.9rem !important;
  min-width:14rem;
  font-size:var(--wp--preset--font-size--s);
  line-height:1.15;
}
.em-search-bar input[type="search"]::placeholder{
  color:color-mix(in srgb, var(--wp--preset--color--emindy-text) 55%, transparent 45%);
}
.em-search-bar button{
  border:0 !important;
  background:var(--wp--preset--color--emindy-gold) !important;
  color:var(--wp--preset--color--emindy-ink) !important;
  border-radius:999px !important;
  padding:0.6rem 1rem !important;
  font-weight:700;
  cursor:pointer;
}
.em-search-bar button:hover{
  box-shadow:var(--wp--preset--shadow--soft);
}

.em-search-list{
  display:flex;
  flex-direction:column;
  gap:0.75rem;
  margin:var(--wp--preset--spacing--m) 0 0;
  padding:0;
  list-style:none;
}

.em-search-item{
  display:flex;
  gap:0.85rem;
  align-items:flex-start;
  padding:var(--wp--preset--spacing--m);
  border:1px solid var(--wp--preset--color--emindy-border);
  border-radius:var(--wp--preset--radius--xl);
  background:var(--wp--preset--color--emindy-surface);
}
.em-search-item__thumb{
  flex:0 0 auto;
  width:72px;
  height:72px;
  border-radius:var(--wp--preset--radius--l);
  overflow:hidden;
  background:color-mix(in srgb, var(--wp--preset--color--emindy-surface) 82%, var(--wp--preset--color--emindy-border) 18%);
  border:1px solid var(--wp--preset--color--emindy-border);
}
.em-search-item__thumb img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}
.em-search-item__main{
  min-width:0;
}
.em-search-item__title{
  margin:0 0 0.25rem;
  font-size:var(--wp--preset--font-size--m);
  font-weight:700;
}
.em-search-item__title a{
  color:var(--wp--preset--color--emindy-text);
  text-decoration:none;
}
.em-search-item__title a:hover{
  color:var(--wp--preset--color--emindy-teal);
  text-decoration:underline;
  text-underline-offset:0.18em;
}
.em-search-item__meta{
  margin:0.15rem 0 0.4rem;
  font-size:var(--wp--preset--font-size--xs);
  color:var(--wp--preset--color--emindy-muted);
}
.em-excerpt{
  margin:0;
  color:var(--wp--preset--color--emindy-muted);
  font-size:var(--wp--preset--font-size--s);
}
.em-excerpt mark{
  background:color-mix(in srgb, transparent 70%, var(--wp--preset--color--emindy-gold) 30%);
  color:inherit;
  padding:0 0.15em;
  border-radius:0.25em;
}

.em-badges{
  display:flex;
  flex-wrap:wrap;
  gap:0.35rem;
  margin-top:0.35rem;
}
.em-badge{
  display:inline-flex;
  align-items:center;
  gap:0.25rem;
  padding:0.2rem 0.55rem;
  border-radius:999px;
  border:1px solid var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-surface);
  font-size:0.75rem;
  font-weight:700;
  line-height:1.1;
  color:var(--wp--preset--color--emindy-text);
}
.em-badge-em_video{
  border-color:color-mix(in srgb, var(--wp--preset--color--emindy-teal) 55%, var(--wp--preset--color--emindy-border) 45%);
  background:color-mix(in srgb, var(--wp--preset--color--emindy-surface) 88%, var(--wp--preset--color--emindy-teal) 12%);
  color:var(--wp--preset--color--emindy-teal);
}
.em-badge-em_exercise{
  border-color:color-mix(in srgb, var(--wp--preset--color--emindy-gold) 55%, var(--wp--preset--color--emindy-border) 45%);
  background:color-mix(in srgb, var(--wp--preset--color--emindy-surface) 86%, var(--wp--preset--color--emindy-gold) 14%);
  color:var(--wp--preset--color--emindy-ink);
}
.em-badge-em_article{
  border-color:var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-surface);
  color:var(--wp--preset--color--emindy-text);
}

/* -------------------------------------------------------------------------
TOC + chapters
-------------------------------------------------------------------------- */

.em-toc,
.em-chapters{
  border:1px solid var(--wp--preset--color--emindy-border);
  border-radius:var(--wp--preset--radius--xl);
  background:var(--wp--preset--color--emindy-surface);
  padding:var(--wp--preset--spacing--m);
}

.em-toc h2,
.em-chapters h3{
  margin:0 0 0.6rem;
  font-size:var(--wp--preset--font-size--l);
  font-weight:800;
}

.em-toc ol,
.em-chapters ol{
  margin:0;
  padding-inline-start:1.25rem;
}

.em-toc li,
.em-chapters li{
  margin:0.35rem 0;
}

.em-chapters a{
  color:var(--wp--preset--color--emindy-teal);
  text-decoration:none;
}
.em-chapters a:hover{
  text-decoration:underline;
  text-underline-offset:0.18em;
}

/* -------------------------------------------------------------------------
Exercise steps list (non-player)
-------------------------------------------------------------------------- */

.em-exercise-steps{
  margin:0;
  padding:0;
  list-style:none;
  display:flex;
  flex-direction:column;
  gap:0.6rem;
}
.em-exercise-step{
  border:1px solid var(--wp--preset--color--emindy-border);
  border-radius:var(--wp--preset--radius--l);
  background:var(--wp--preset--color--emindy-surface);
  padding:var(--wp--preset--spacing--m);
}
.em-exercise-step__title{
  margin:0 0 0.35rem;
  font-weight:800;
}
.em-exercise-step__body{
  margin:0;
  color:var(--wp--preset--color--emindy-muted);
}

/* -------------------------------------------------------------------------
Newsletter
-------------------------------------------------------------------------- */

.em-newsletter{
  border:1px solid var(--wp--preset--color--emindy-border);
  border-radius:var(--wp--preset--radius--xl);
  background:var(--wp--preset--color--emindy-surface);
  padding:var(--wp--preset--spacing--l);
}

.em-newsletter h3{
  margin:0 0 0.4rem;
  font-size:var(--wp--preset--font-size--xl);
  font-weight:800;
}
.em-newsletter p{
  margin:0.35rem 0;
  color:var(--wp--preset--color--emindy-muted);
}

.em-newsletter-form{
  margin-top:var(--wp--preset--spacing--m);
  display:grid;
  gap:0.75rem;
}

@media (min-width: 600px){
  .em-newsletter-form__row{
    display:grid;
    grid-template-columns: 1fr auto;
    gap:0.75rem;
    align-items:center;
  }
}

.em-newsletter-form__input{
  width:100%;
  border:1px solid var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-bg);
  color:var(--wp--preset--color--emindy-text);
  border-radius:999px;
  padding:0.65rem 0.95rem;
  font-size:var(--wp--preset--font-size--s);
  line-height:1.2;
}
.em-newsletter-form__input::placeholder{
  color:color-mix(in srgb, var(--wp--preset--color--emindy-text) 55%, transparent 45%);
}

.em-newsletter-form__button{
  border:0;
  background:var(--wp--preset--color--emindy-gold);
  color:var(--wp--preset--color--emindy-ink);
  border-radius:999px;
  padding:0.65rem 1.1rem;
  font-weight:800;
  cursor:pointer;
}
.em-newsletter-form__button:hover{
  box-shadow:var(--wp--preset--shadow--soft);
}

.em-newsletter-form__consent{
  display:flex;
  gap:0.5rem;
  align-items:flex-start;
  color:var(--wp--preset--color--emindy-muted);
  font-size:var(--wp--preset--font-size--xs);
  line-height:1.4;
}

.em-newsletter-form__notice{
  border-radius:var(--wp--preset--radius--l);
  padding:0.65rem 0.9rem;
  border:1px solid var(--wp--preset--color--emindy-border);
  background:var(--wp--preset--color--emindy-bg);
  color:var(--wp--preset--color--emindy-text);
  font-size:var(--wp--preset--font-size--s);
}
.em-newsletter-form__notice.is-success{
  border-color:color-mix(in srgb, var(--wp--preset--color--emindy-success) 45%, var(--wp--preset--color--emindy-border) 55%);
  background:color-mix(in srgb, var(--wp--preset--color--emindy-bg) 90%, var(--wp--preset--color--emindy-success) 10%);
}
.em-newsletter-form__notice.is-error{
  border-color:color-mix(in srgb, var(--wp--preset--color--emindy-danger) 45%, var(--wp--preset--color--emindy-border) 55%);
  background:color-mix(in srgb, var(--wp--preset--color--emindy-bg) 90%, var(--wp--preset--color--emindy-danger) 10%);
}

/* -------------------------------------------------------------------------
Assessments (override plugin hard-coded colors using presets)
-------------------------------------------------------------------------- */

.em-assessment,
.em-phq9{
  --em-assessment-text-color: var(--wp--preset--color--emindy-text);
  --em-assessment-muted-color: var(--wp--preset--color--emindy-muted);
  --em-assessment-chip-bg: color-mix(in srgb, transparent 88%, var(--wp--preset--color--emindy-teal) 12%);
  --em-assessment-chip-text: var(--wp--preset--color--emindy-teal);

  --em-assessment-border-default: var(--wp--preset--color--emindy-border);
  --em-assessment-border-minimal: var(--wp--preset--color--emindy-success);
  --em-assessment-border-mild: var(--wp--preset--color--emindy-teal);
  --em-assessment-border-moderate: var(--wp--preset--color--emindy-gold);
  --em-assessment-border-severe: var(--wp--preset--color--emindy-danger);
}

.em-assessment__question,
.em-phq9__question{
  background:var(--wp--preset--color--emindy-surface);
}
.em-assessment__option,
.em-phq9__option{
  border-color:var(--wp--preset--color--emindy-border);
  background-color:var(--wp--preset--color--emindy-bg);
  color:var(--wp--preset--color--emindy-text);
}
.em-assessment__option.is-selected,
.em-phq9__option.is-selected{
  border-color:var(--wp--preset--color--emindy-teal);
  background-color:color-mix(in srgb, var(--wp--preset--color--emindy-bg) 88%, var(--wp--preset--color--emindy-teal) 12%);
}

/* RTL-safe accent border */
@supports (border-inline-start: 4px solid transparent){
  .em-assessment__score,
  .em-phq9__score{
    border-left:0;
    padding-left:0;
    border-inline-start:4px solid var(--em-assessment-border-default);
    padding-inline-start:var(--em-assessment-border-padding);
  }
}

/* -------------------------------------------------------------------------
Dark-mode overrides: only for WP utility classes (minimal)
-------------------------------------------------------------------------- */

:root[data-em-theme="dark"] .has-emindy-bg-background-color{
  background-color:var(--wp--preset--color--emindy-bg) !important;
}
:root[data-em-theme="dark"] .has-emindy-surface-background-color{
  background-color:var(--wp--preset--color--emindy-surface) !important;
}
:root[data-em-theme="dark"] :where(.has-emindy-text-color, .has-emindy-navy-color, .has-emindy-ink-color){
  color:var(--wp--preset--color--emindy-text) !important;
}
:root[data-em-theme="dark"] .has-emindy-muted-color{
  color:var(--wp--preset--color--emindy-muted) !important;
}

/* If OS is dark but user forces LIGHT, neutralize plugin prefers-color-scheme rules */
@media (prefers-color-scheme: dark){
  :root[data-em-theme="light"] :where(.em-p, .em-phq9, .em-assessment){
    color:var(--wp--preset--color--emindy-text);
  }
  :root[data-em-theme="light"] .em-p{
    background:var(--wp--preset--color--emindy-surface);
    border-color:var(--wp--preset--color--emindy-border);
    box-shadow:var(--em-card-shadow);
  }
  :root[data-em-theme="light"] :where(.em-p__btn, .em-p__top, .em-p__barwrap, .em-p__list li){
    background:var(--wp--preset--color--emindy-surface);
    border-color:var(--wp--preset--color--emindy-border);
    color:var(--wp--preset--color--emindy-text);
  }
  :root[data-em-theme="light"] .em-p__bar{
    background:var(--wp--preset--color--emindy-teal);
  }
}

/* -------------------------------------------------------------------------
Print
-------------------------------------------------------------------------- */

@media print{
  .em-dark-mode-toggle,
  .em-lang-switcher,
  .em-newsletter,
  .skip-link{
    display:none !important;
  }
}
